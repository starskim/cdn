(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{132:function(e,t,a){"use strict";function s(e){return t=>{if(!t)return e}}a.d(t,"a",(function(){return s}))},133:function(e,t,a){var s=a(391);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,a(405).default)("1af496f6",s,!0,{})},142:function(e,t,a){"use strict";var s=a(6),i=a.n(s),n=a(1),r={name:"Modal",props:{mode:{type:String,default:"confirm",validator:e=>["alert","confirm","prompt"].includes(e)},id:{type:String},title:{type:String,default:Object(n.b)("general.tip")},text:{type:String,default:""},dangerousHTML:{type:String},input:{type:String,default:""},placeholder:{type:String},inputType:{type:String,default:"text"},validator:{type:Function},type:{type:String,default:"default"},showHeader:{type:Boolean,default:!0},center:{type:Boolean,default:!1},okButtonText:{type:String,default:Object(n.b)("general.confirm")},okButtonType:{type:String,default:"primary"},cancelButtonText:{type:String,default:Object(n.b)("general.cancel")},cancelButtonType:{type:String,default:"secondary"},flexFooter:{type:Boolean,default:!1}},data(){return{hidden:!1,value:this.input,valid:!0,validatorMessage:""}},computed:{lines(){return this.text.split(/\r?\n/)},footerClasses(){return{"d-flex":this.flexFooter,"justify-content-between":this.flexFooter}}},mounted(){i()(this.$el).on("hide.bs.modal",()=>{this.hidden||this.dismiss()}).on("hidden.bs.modal",()=>{this.hidden=!1})},methods:{confirm(){if("function"==typeof this.validator){const e=this.validator(this.value);if("string"==typeof e)return this.validatorMessage=e,void(this.valid=!1)}this.hidden=!0,this.$emit("confirm",{value:this.value}),i()(this.$el).modal("hide")},dismiss(){this.hidden=!0,this.$emit("dismiss")}}},o=a(71),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal fade",attrs:{id:e.id,tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",class:{"modal-dialog-centered":e.center},attrs:{role:"document"}},[a("div",{staticClass:"modal-content",class:["bg-"+e.type]},[e.showHeader?a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v(e._s(e.title))]),e._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:e.dismiss}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])])]):e._e(),e._v(" "),a("div",{staticClass:"modal-body"},[e._t("default",[e.text?e._l(e.lines,(function(t,s){return a("p",{key:s},[e._v(e._s(t))])})):e.dangerousHTML?a("div",{domProps:{innerHTML:e._s(e.dangerousHTML)}}):e._e(),e._v(" "),"prompt"===e.mode?[a("div",{staticClass:"form-group"},["checkbox"===e.inputType?a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"form-control",attrs:{placeholder:e.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{input:function(t){e.valid=!0},change:function(t){var a=e.value,s=t.target,i=!!s.checked;if(Array.isArray(a)){var n=e._i(a,null);s.checked?n<0&&(e.value=a.concat([null])):n>-1&&(e.value=a.slice(0,n).concat(a.slice(n+1)))}else e.value=i}}}):"radio"===e.inputType?a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"form-control",attrs:{placeholder:e.placeholder,type:"radio"},domProps:{checked:e._q(e.value,null)},on:{input:function(t){e.valid=!0},change:function(t){e.value=null}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"form-control",attrs:{placeholder:e.placeholder,type:e.inputType},domProps:{value:e.value},on:{input:[function(t){t.target.composing||(e.value=t.target.value)},function(t){e.valid=!0}]}})]),e._v(" "),e.valid?e._e():a("div",{staticClass:"alert alert-danger"},[a("i",{staticClass:"icon far fa-times-circle"}),e._v("\n              "+e._s(e.validatorMessage)+"\n            ")])]:e._e()])],2),e._v(" "),a("div",{staticClass:"modal-footer",class:e.footerClasses},[e._t("footer",["alert"!==e.mode?a("button",{staticClass:"btn",class:["btn-"+e.cancelButtonType],attrs:{type:"button","data-dismiss":"modal"},on:{click:e.dismiss}},[e._v("\n            "+e._s(e.cancelButtonText)+"\n          ")]):e._e(),e._v(" "),a("button",{staticClass:"btn",class:["btn-"+e.okButtonType],attrs:{type:"button"},on:{click:e.confirm}},[e._v("\n            "+e._s(e.okButtonText)+"\n          ")])])],2)])])])}),[],!1,null,null,null);t.a=l.exports},390:function(e,t,a){"use strict";var s=a(133);a.n(s).a},391:function(e,t,a){(t=a(9)(!1)).push([e.i,".operations-menu {\n  margin-left: -35px;\n}\n.fa-edit {\n  cursor: pointer;\n}\n.fa-toggle-on,\n.fa-toggle-off {\n  font-size: 18px;\n  cursor: pointer;\n}\n.row-at-bottom {\n  margin-top: -100px;\n}\n",""]),e.exports=t},405:function(e,t,a){"use strict";function s(e,t){for(var a=[],s={},i=0;i<t.length;i++){var n=t[i],r=n[0],o={id:e+":"+i,css:n[1],media:n[2],sourceMap:n[3]};s[r]?s[r].parts.push(o):a.push(s[r]={id:r,parts:[o]})}return a}a.r(t),a.d(t,"default",(function(){return f}));var i="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},r=i&&(document.head||document.getElementsByTagName("head")[0]),o=null,l=0,d=!1,c=function(){},u=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,a,i){d=a,u=i||{};var r=s(e,t);return h(r),function(t){for(var a=[],i=0;i<r.length;i++){var o=r[i];(l=n[o.id]).refs--,a.push(l)}t?h(r=s(e,t)):r=[];for(i=0;i<a.length;i++){var l;if(0===(l=a[i]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete n[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var a=e[t],s=n[a.id];if(s){s.refs++;for(var i=0;i<s.parts.length;i++)s.parts[i](a.parts[i]);for(;i<a.parts.length;i++)s.parts.push(g(a.parts[i]));s.parts.length>a.parts.length&&(s.parts.length=a.parts.length)}else{var r=[];for(i=0;i<a.parts.length;i++)r.push(g(a.parts[i]));n[a.id]={id:a.id,refs:1,parts:r}}}}function v(){var e=document.createElement("style");return e.type="text/css",r.appendChild(e),e}function g(e){var t,a,s=document.querySelector("style["+m+'~="'+e.id+'"]');if(s){if(d)return c;s.parentNode.removeChild(s)}if(p){var i=l++;s=o||(o=v()),t=w.bind(null,s,i,!1),a=w.bind(null,s,i,!0)}else s=v(),t=_.bind(null,s),a=function(){s.parentNode.removeChild(s)};return t(e),function(s){if(s){if(s.css===e.css&&s.media===e.media&&s.sourceMap===e.sourceMap)return;t(e=s)}else a()}}var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function w(e,t,a,s){var i=a?"":s.css;if(e.styleSheet)e.styleSheet.cssText=y(t,i);else{var n=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(n,r[t]):e.appendChild(n)}}function _(e,t){var a=t.css,s=t.media,i=t.sourceMap;if(s&&e.setAttribute("media",s),u.ssrId&&e.setAttribute(m,t.id),i&&(a+="\n/*# sourceURL="+i.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},429:function(e,t,a){"use strict";a.r(t);var s=a(104),i=(a(103),a(1)),n=a(142),r=a(58),o=a(84),l=a(59),d=a(3),c=a(132),u={name:"UsersManagement",components:{Modal:n.a,VueGoodTable:s.a},filters:{humanizePermission(e){switch(e.permission){case-1:return Object(i.b)("admin.banned");case 0:return Object(i.b)("admin.normal");case 1:return Object(i.b)("admin.admin");case 2:return Object(i.b)("admin.superAdmin");default:return""}},playersLink:e=>`${blessing.base_url}/admin/players?uid=${e.uid}`},mixins:[l.a,r.a,o.a],data(){return{users:[],columns:[{field:"uid",label:"UID",type:"number"},{field:"email",label:this.$t("general.user.email")},{field:"nickname",label:this.$t("general.user.nickname"),width:"150px"},{field:"score",label:this.$t("general.user.score"),type:"number",width:"102px"},{field:"players_count",label:this.$t("admin.playersCount"),type:"number",sortable:!1},{field:"permission",label:this.$t("admin.permission"),globalSearchDisabled:!0},{field:"verified",label:this.$t("admin.verification"),type:"boolean",globalSearchDisabled:!0},{field:"register_at",label:this.$t("general.user.register-at")},{field:"operations",label:this.$t("admin.operationsTitle"),sortable:!1,globalSearchDisabled:!0}],editingUser:{},permission:0}},beforeMount(){this.fetchData()},methods:{async fetchData(){const{data:e,totalRecords:t}=await this.$http.get(`/admin/users/list${location.search}`,!location.search&&this.serverParams);this.totalRecords=t,this.users=e},async changeEmail(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newUserEmail"),input:e.email,validator:Object(c.a)(this.$t("auth.emptyEmail"))}))}catch{return}const{code:a,message:s}=await this.$http.post("/admin/users?action=email",{uid:e.uid,email:t});0===a?(e.email=t,d.b.success(s)):d.b.error(s)},async toggleVerification(e){const{code:t,message:a}=await this.$http.post("/admin/users?action=verification",{uid:e.uid});0===t?(e.verified=!e.verified,d.b.success(a)):d.b.error(a)},async changeNickName(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newUserNickname"),input:e.nickname,validator:Object(c.a)(this.$t("auth.emptyNickname"))}))}catch{return}const{code:a,message:s}=await this.$http.post("/admin/users?action=nickname",{uid:e.uid,nickname:t});0===a?(e.nickname=t,d.b.success(s)):d.b.error(s)},async changePassword(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newUserPassword"),inputType:"password"}))}catch{return}const{code:a,message:s}=await this.$http.post("/admin/users?action=password",{uid:e.uid,password:t});0===a?d.b.success(s):d.b.error(s)},async changeScore(e){let t;try{({value:t}=await Object(d.a)({mode:"prompt",text:this.$t("admin.newScore"),input:e.score,inputType:"number"}))}catch{return}const a=Number.parseInt(t),{code:s,message:i}=await this.$http.post("/admin/users?action=score",{uid:e.uid,score:a});0===s?(e.score=a,d.b.success(i)):d.b.error(i)},async changePermission(){const e=Number.parseInt(this.permission),{code:t,message:a}=await this.$http.post("/admin/users?action=permission",{uid:this.editingUser.uid,permission:e});0===t?(this.editingUser.permission=e,d.b.success(a)):d.b.error(a)},async deleteUser({uid:e,originalIndex:t}){try{await Object(d.a)({text:this.$t("admin.deleteUserNotice"),okButtonType:"danger"})}catch{return}const{code:a,message:s}=await this.$http.post("/admin/users?action=delete",{uid:e});0===a?(this.$delete(this.users,t),d.b.success(s)):d.b.error(s)}}},m=(a(390),a(71)),p=Object(m.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("vue-good-table",{attrs:{mode:"remote",rows:e.users,"total-rows":e.totalRecords||e.users.length,columns:e.columns,"search-options":e.tableOptions.search,"pagination-options":e.tableOptions.pagination,"style-class":"vgt-table striped"},on:{"on-page-change":e.onPageChange,"on-sort-change":e.onSortChange,"on-search":e.onSearch,"on-per-page-change":e.onPerPageChange},scopedSlots:e._u([{key:"table-row",fn:function(t){return["email"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changeEmail"),"data-test":"email"},on:{click:function(a){return e.changeEmail(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"nickname"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changeNickName"),"data-test":"nickname"},on:{click:function(a){return e.changeNickName(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"score"===t.column.field?a("span",[e._v("\n        "+e._s(t.formattedRow[t.column.field])+"\n        "),a("a",{attrs:{title:e.$t("admin.changeScore"),"data-test":"score"},on:{click:function(a){return e.changeScore(t.row)}}},[a("i",{staticClass:"fas fa-edit btn-edit"})])]):"players_count"===t.column.field?a("span",[a("a",{attrs:{href:e._f("playersLink")(t.row),title:e.$t("admin.inspectHisPlayers"),"data-toggle":"tooltip","data-placement":"right"}},[e._v(e._s(t.formattedRow[t.column.field]))])]):"permission"===t.column.field?a("span",[a("span",[e._v(e._s(e._f("humanizePermission")(t.row)))]),e._v(" "),t.row.permission<1||2===t.row.operations&&t.row.permission<2?a("a",{attrs:{title:e.$t("admin.changePermission"),"data-toggle":"modal","data-target":"#modal-permission","data-test":"permission"},on:{click:function(a){e.editingUser=t.row,e.permission=t.row.permission}}},[a("i",{staticClass:"fas fa-edit btn-edit"})]):e._e()]):"verified"===t.column.field?a("span",[t.row.verified?a("span",{directives:[{name:"t",rawName:"v-t",value:"admin.verified",expression:"'admin.verified'"}]}):a("span",{directives:[{name:"t",rawName:"v-t",value:"admin.unverified",expression:"'admin.unverified'"}]}),e._v(" "),a("a",{attrs:{title:e.$t("admin.toggleVerification"),"data-test":"verification"},on:{click:function(a){return e.toggleVerification(t.row)}}},[a("i",{staticClass:"fas btn-edit",class:{"fa-toggle-on":t.row.verified,"fa-toggle-off":!t.row.verified}})])]):"operations"===t.column.field?a("div",[a("button",{staticClass:"btn btn-default",on:{click:function(a){return e.changePassword(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.changePassword"))+"\n        ")]),e._v(" "),a("button",{staticClass:"btn btn-danger",attrs:{disabled:t.row.permission>=2||1===t.row.operations&&t.row.permission>=1,"data-test":"deleteUser"},on:{click:function(a){return e.deleteUser(t.row)}}},[e._v("\n          "+e._s(e.$t("admin.deleteUser"))+"\n        ")])]):a("span",{domProps:{textContent:e._s(t.formattedRow[t.column.field])}})]}}])}),e._v(" "),a("modal",{attrs:{id:"modal-permission",title:e.$t(this.$t("admin.newPermission")),center:""},on:{confirm:e.changePermission}},[a("label",{staticClass:"mr-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],attrs:{type:"radio",name:"permission"},domProps:{value:-1,checked:e._q(e.permission,-1)},on:{change:function(t){e.permission=-1}}}),e._v("\n      "+e._s(e.$t("admin.banned"))+"\n    ")]),e._v(" "),a("label",{staticClass:"mr-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],attrs:{type:"radio",name:"permission"},domProps:{value:0,checked:e._q(e.permission,0)},on:{change:function(t){e.permission=0}}}),e._v("\n      "+e._s(e.$t("admin.normal"))+"\n    ")]),e._v(" "),2===e.editingUser.operations?a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.permission,expression:"permission"}],attrs:{type:"radio",name:"permission"},domProps:{value:1,checked:e._q(e.permission,1)},on:{change:function(t){e.permission=1}}}),e._v("\n      "+e._s(e.$t("admin.admin"))+"\n    ")]):e._e()])],1)}),[],!1,null,null,null);t.default=p.exports},58:function(e,t,a){"use strict";var s=a(44);t.a=s.default.extend({data(){return{tableOptions:{search:{enabled:!0,placeholder:this.$t("vendor.datatable.search")},pagination:{enabled:!0,nextLabel:this.$t("vendor.datatable.next"),prevLabel:this.$t("vendor.datatable.prev"),rowsPerPageLabel:this.$t("vendor.datatable.rowsPerPage"),allLabel:this.$t("vendor.datatable.all"),ofLabel:this.$t("vendor.datatable.of")}}}}})},59:function(e,t,a){"use strict";var s=a(44),i=a(2);t.a=s.default.extend({mounted(){i.a("mounted",{el:this.$root.$options.el})}})},84:function(e,t,a){"use strict";var s=a(44);t.a=s.default.extend({data:()=>({columns:[{field:"id"}],totalRecords:0,serverParams:{sortField:"id",sortType:"asc",page:1,perPage:10,search:""}}),created(){this.serverParams.sortField=this.columns[0].field},methods:{fetchData:()=>Promise.resolve(),onPageChange(e){this.serverParams.page=e.currentPage,this.fetchData()},onPerPageChange(e){this.serverParams.perPage=e.currentPerPage,this.fetchData()},onSortChange([e]){this.serverParams.sortType=e.type,this.serverParams.sortField=e.field,this.fetchData()},onSearch(e){this.serverParams.search=e.searchTerm,this.fetchData()}}})}}]);