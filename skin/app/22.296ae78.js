(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{144:function(e,a,t){"use strict";var n=t(0),c=t(7),l=t(1);const r=c.b`
  ::after {
    display: none;
  }
`;a.a=e=>{var a;const t=Object(n.useRef)(null);return Object(c.c)("div",{className:"form-group"},Object(c.c)("label",{htmlFor:"select-file"},Object(l.a)("skinlib.upload.select-file")),Object(c.c)("div",{className:"input-group"},Object(c.c)("div",{className:"custom-file"},Object(c.c)("input",{type:"file",className:"custom-file-input",id:"select-file",accept:e.accept,title:Object(l.a)("skinlib.upload.select-file"),ref:t,onChange:e.onChange}),Object(c.c)("label",{className:"custom-file-label",css:r},null===(a=e.file)||void 0===a?void 0:a.name)),Object(c.c)("div",{className:"input-group-append"},Object(c.c)("button",{className:"btn btn-default",onClick:()=>{t.current.click()}},Object(l.a)("skinlib.upload.select-file")))))}},34:function(e,a,t){a.hot=function(e){return e}},42:function(e,a,t){"use strict";var n,c;t.d(a,"b",(function(){return n})),t.d(a,"a",(function(){return c})),function(e){e[e.Banned=-1]="Banned",e[e.Normal=0]="Normal",e[e.Admin=1]="Admin",e[e.SuperAdmin=2]="SuperAdmin"}(n||(n={})),function(e){e.Steve="steve",e.Alex="alex",e.Cape="cape"}(c||(c={}))},421:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),l=t(5),r=t.n(l),i=t(34),s=t(1),o=t(56),u=t(71),d=t(9),m=t(4);function b(e,a,t,n,c){for(var l=e.getImageData(a,t,n,c),r=0;r<n;r++)for(var i=0;i<c;i++){var s=4*(r+i*n);if(255!==l.data[s+3])return!0}return!1}function p(e){return e/64}function f(e,a){var t=p(a),n=function(a,n,c,l,r,i,s){return function(e,a,t,n,c,l,r,i){var s=e.getImageData(a,t,n,c);if(i)for(var o=0;o<c;o++)for(var u=0;u<n/2;u++){var d=4*(u+o*n),m=4*(n-u-1+o*n),b=s.data[d],p=s.data[d+1],f=s.data[d+2],v=s.data[d+3],h=s.data[m],g=s.data[m+1],j=s.data[m+2],O=s.data[m+3];s.data[d]=h,s.data[d+1]=g,s.data[d+2]=j,s.data[d+3]=O,s.data[m]=b,s.data[m+1]=p,s.data[m+2]=f,s.data[m+3]=v}e.putImageData(s,l,r)}(e,a*t,n*t,c*t,l*t,r*t,i*t,s)};!function(e,a){if(!b(e,0,0,a,a/2)){var t=p(a),n=function(a,n,c,l){return e.clearRect(a*t,n*t,c*t,l*t)};n(40,0,8,8),n(48,0,8,8),n(32,8,8,8),n(40,8,8,8),n(48,8,8,8),n(56,8,8,8)}}(e,a),n(4,16,4,4,20,48,!0),n(8,16,4,4,24,48,!0),n(0,20,4,12,24,52,!0),n(4,20,4,12,20,52,!0),n(8,20,4,12,16,52,!0),n(12,20,4,12,28,52,!0),n(44,16,4,4,36,48,!0),n(48,16,4,4,40,48,!0),n(40,20,4,12,40,52,!0),n(44,20,4,12,36,52,!0),n(48,20,4,12,32,52,!0),n(52,20,4,12,44,52,!0)}function v(e,a,t){const n=e.getImageData(a,t,1,1);return 0===n.data[0]&&0===n.data[1]&&0===n.data[2]}function h(e){return new Promise(a=>{const t=new Image;t.src=e,t.onload=()=>{if(t.width!==t.height)return void a(!1);const e=document.createElement("canvas");!function(e,a){var t=!1;if(a.width!==a.height){if(a.width!==2*a.height)throw new Error("Bad skin size: "+a.width+"x"+a.height);t=!0}var n=e.getContext("2d");if(t){var c=a.width;e.width=c,e.height=c,n.clearRect(0,0,c,c),n.drawImage(a,0,0,c,c/2),f(n,c)}else e.width=a.width,e.height=a.height,n.clearRect(0,0,a.width,a.height),n.drawImage(a,0,0,e.width,e.height)}(e,t);const n=e.width/64,c=e.getContext("2d");if(c){for(let e=46*n;e<48*n;e+=1)for(let t=52*n;t<64*n;t+=1)if(!v(c,e,t))return void a(!1);a(!0)}else a(!1)}})}var g=t(42),j=t(14),O=t(144),E=t(62);const w=c.a.lazy(()=>Promise.all([t.e(0),t.e(2)]).then(t.bind(null,146)));a.default=Object(i.hot)(()=>{var e;const[a,t]=Object(n.useState)(""),[l,i]=Object(n.useState)(g.a.Steve),[b,p]=Object(n.useState)(!1),[f,v]=Object(n.useState)(!1),[N,k]=Object(n.useState)(null),[y,x]=Object(n.useState)(""),C=Object(o.a)("rule"),S=Object(o.a)("contentPolicy"),A=Object(o.a)("privacyNotice"),I=Object(o.a)("award"),F=Object(o.a)("score",0),P=Object(o.a)("scorePublic"),R=Object(o.a)("scorePrivate"),D=Object(o.a)("closetItemCost"),B=Object(u.a)("#previewer"),_=e=>{i(e.target.value)},z=b?R:P,L=null!==(e=null==N?void 0:N.size)&&void 0!==e?e:0,M=Math.ceil(L/1024)*z+D;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"card card-primary"},c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"texture-name"},Object(s.a)("skinlib.upload.texture-name")),c.a.createElement("input",{className:"form-control",id:"texture-name",type:"text",placeholder:C,value:a,onChange:e=>{t(e.target.value)}})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",null,Object(s.a)("skinlib.upload.texture-type")),c.a.createElement("br",null),c.a.createElement("label",{className:"mr-4"},c.a.createElement("input",{type:"radio",className:"mr-1",name:"type",value:"steve",checked:l===g.a.Steve,onChange:_}),"Steve"),c.a.createElement("label",{className:"mr-4"},c.a.createElement("input",{type:"radio",className:"mr-1",name:"type",value:"alex",checked:l===g.a.Alex,onChange:_}),"Alex"),c.a.createElement("label",{className:"mr-4"},c.a.createElement("input",{type:"radio",className:"mr-1",name:"type",value:"cape",checked:l===g.a.Cape,onChange:_}),Object(s.a)("general.cape"))),c.a.createElement(O.a,{file:N,accept:"image/png, image/x-png",onChange:async e=>{const n=e.target.files,[c]=n;if(c){k(c),!a&&c.name.endsWith(".png")&&t(c.name.slice(0,c.name.length-4));const e=URL.createObjectURL(c);x(e),l!==g.a.Cape&&i(await h(e)?g.a.Alex:g.a.Steve)}}}),S&&c.a.createElement("div",{className:"callout callout-warning",dangerouslySetInnerHTML:{__html:S}})),c.a.createElement("div",{className:"card-footer"},c.a.createElement("div",{className:"container px-0 d-flex justify-content-between"},c.a.createElement("label",{className:"mt-2",htmlFor:"is-private",title:Object(s.a)("skinlib.upload.privacy-notice")},c.a.createElement("input",{type:"checkbox",id:"is-private",className:"mr-1",checked:b,onChange:e=>{p(e.target.checked)}}),Object(s.a)("skinlib.upload.set-as-private")),c.a.createElement("button",{className:"btn btn-success",disabled:f,onClick:async()=>{if(!N)return void m.b.error(Object(s.a)("skinlib.emptyUploadFile"));if(!a)return void m.b.error(Object(s.a)("skinlib.emptyTextureName"));if("image/png"!==N.type&&"image/x-png"!==N.type)return void m.b.error(Object(s.a)("skinlib.fileExtError"));const e=new FormData;e.append("name",a),e.append("type",l),e.append("file",N,N.name),e.append("public",(!b).toString()),v(!0);const{code:t,message:n,data:{tid:c}={tid:0}}=await d.c(j.a.skinlib.upload(),e);if(v(!1),0===t)window.location.href=blessing.base_url+j.a.skinlib.show(c);else if(2===t)try{await Object(m.a)({mode:"confirm",text:n,okButtonText:Object(s.a)("user.viewInSkinlib")}),window.location.href=blessing.base_url+j.a.skinlib.show(c)}catch(e){}else m.b.error(n)}},f?c.a.createElement(c.a.Fragment,null,c.a.createElement("i",{className:"fas fa-spinner fa-spin mr-1"}),c.a.createElement("span",null,Object(s.a)("skinlib.uploading"))):Object(s.a)("skinlib.upload.button"))),N&&c.a.createElement("div",{className:`callout callout-${F>M?"success":"danger"} mt-3`},c.a.createElement("div",null,Object(s.a)("skinlib.upload.cost",{score:M})),c.a.createElement("div",null,Object(s.a)("user.cur-score"),c.a.createElement("span",{className:"ml-1"},F))),b&&c.a.createElement("div",{className:"callout callout-info mt-3"},A),!b&&I>0&&c.a.createElement("div",{className:"callout callout-success mt-3"},Object(s.a)("skinlib.upload.award",{score:I})))),r.a.createPortal(c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(E.a,null)},c.a.createElement(w,{skin:l!==g.a.Cape?y:void 0,cape:l===g.a.Cape?y:void 0,isAlex:l===g.a.Alex})),B))})},56:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t(0);function c(e,a){const[t,c]=Object(n.useState)(a);return Object(n.useEffect)(()=>{c(blessing.extra[e])},[]),t}},62:function(e,a,t){"use strict";var n=t(0),c=t.n(n),l=t(1);a.a=()=>c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header"},c.a.createElement("div",{className:"d-flex justify-content-between"},c.a.createElement("h3",{className:"card-title"},c.a.createElement("span",null,Object(l.a)("general.texturePreview"))))),c.a.createElement("div",{className:"card-body"}))},71:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t(0);function c(e){const a=Object(n.useMemo)(()=>document.createElement("div"),[]);return Object(n.useEffect)(()=>{const t=document.querySelector(e);return t.appendChild(a),()=>{t.removeChild(a)}},[]),a}}}]);